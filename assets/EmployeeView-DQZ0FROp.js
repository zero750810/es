import{r as e,c as a,a as l,l as s,f as t,g as n,j as u,k as r,z as o,A as i,C as d,F as c,h as v,t as p,y as m,n as y,o as b}from"./vue-B-cAkLc6.js";import{s as h,u as w,b as g,_ as f}from"./index-BVk54o67.js";import"./vendor-C7jwa7K6.js";const E=e([]);let k=0;const _=()=>{const e=(e,l,s,t=5e3)=>{const n=`toast_${++k}_${Date.now()}`,u={id:n,type:e,title:l,message:s,duration:t,timestamp:Date.now()};return E.value.push(u),t>0&&setTimeout(()=>{a(n)},t),n},a=e=>{const a=E.value.findIndex(a=>a.id===e);a>-1&&E.value.splice(a,1)};return{toasts:E,addToast:e,removeToast:a,clearToasts:()=>{E.value=[]},success:(a,l,s=4e3)=>e("success",a,l,s),error:(a,l,s=6e3)=>e("error",a,l,s),warning:(a,l,s=5e3)=>e("warning",a,l,s),info:(a,l,s=4e3)=>e("info",a,l,s),consoleOutput:(e,a,l)=>{}}},C={class:"employee"},P={class:"page-header"},I={class:"filters"},T={key:0,class:"loading"},V={key:1,class:"empty-state"},A={key:2,class:"employee-table"},N=["onClick"],U={class:"employee-name"},S={class:"employee-email"},O={class:"salary"},D={class:"modal-header"},L={class:"form-grid"},R={class:"form-column"},$={class:"form-group"},x={class:"form-group"},j=["disabled"],M={key:0,class:"form-group"},Y={key:1,class:"form-group"},z={class:"form-group"},J={class:"form-column"},q={class:"form-group"},X={class:"form-group"},W={class:"form-group"},B={class:"form-group"},F={class:"form-group"},H={class:"form-group"},Q={key:0,class:"form-group"},Z={class:"modal-actions"},G=["disabled"],K={class:"modal-body"},ee={class:"detail-grid"},ae={class:"detail-section"},le={class:"detail-item"},se={class:"detail-item"},te={class:"detail-item"},ne={class:"detail-item"},ue={class:"detail-section"},re={class:"detail-item"},oe={class:"detail-item"},ie={class:"detail-item"},de={class:"detail-section"},ce={class:"detail-item"},ve={class:"salary"},pe={class:"detail-item"},me={class:"detail-item"},ye={class:"detail-section"},be={class:"detail-item"},he={class:"detail-item"},we={key:0,class:"detail-item"},ge={class:"modal-actions"},fe={class:"modal-header"},Ee={class:"form-group"},ke={class:"form-group"},_e={key:0,class:"error-message"},Ce={class:"modal-actions"},Pe=["disabled"],Ie={key:6,class:"loading-overlay"},Te=f(l({__name:"EmployeeView",setup(l){const f=g(),E=(()=>{const a=_(),l=e(!1),s=async(e,a)=>{l.value=!0;try{const{data:{session:l}}=await h.auth.getSession();if(!l)throw new Error("æœªæ‰¾åˆ°èªè­‰æœƒè©±ï¼Œè«‹é‡æ–°ç™»å…¥");const s=await fetch("https://yuyxhxsrvbpauvadrppc.supabase.co/functions/v1/manage-employee-auth",{method:"POST",headers:{Authorization:`Bearer ${l.access_token}`,"Content-Type":"application/json",apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl1eXhoeHNydmJwYXV2YWRycHBjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMwODQzNTQsImV4cCI6MjA2ODY2MDM1NH0.VLz_X7N2gisz59c2taxxT-WN_TNT2ayfaIYUAj_yS4A"},body:JSON.stringify({operation:e,employeeData:a})}),t=await s.json();if(!s.ok)throw new Error(t.error||"æ“ä½œå¤±æ•—");return t}catch(s){const e=s instanceof Error?s.message:"æœªçŸ¥éŒ¯èª¤";throw new Error(e)}finally{l.value=!1}},t=async(e,l)=>{try{const t=await s("RESET_PASSWORD",{id:e,name:"",mail:"",role:0,newPassword:l});return a.success(t.message||"å¯†ç¢¼é‡è¨­æˆåŠŸ"),t}catch(t){const e=t instanceof Error?t.message:"å¯†ç¢¼é‡è¨­å¤±æ•—";throw a.error(e),t}},n=e({isRunning:!1,current:0,total:0,currentOperation:""});return{isLoading:l,batchOperation:n,createEmployee:async e=>{try{const l=await s("CREATE_EMPLOYEE",e);return a.success(l.message||"å“¡å·¥å‰µå»ºæˆåŠŸ"),l}catch(l){const e=l instanceof Error?l.message:"å‰µå»ºå“¡å·¥å¤±æ•—";throw a.error(e),l}},updateEmployee:async e=>{try{const l=await s("UPDATE_EMPLOYEE",e);return a.success(l.message||"å“¡å·¥è³‡æ–™æ›´æ–°æˆåŠŸ"),l}catch(l){const e=l instanceof Error?l.message:"æ›´æ–°å“¡å·¥è³‡æ–™å¤±æ•—";throw a.error(e),l}},resetEmployeePassword:t,deactivateEmployee:async e=>{try{const l=await s("DEACTIVATE_EMPLOYEE",{id:e,name:"",mail:"",role:0});return a.success(l.message||"å“¡å·¥å·²åœç”¨"),l}catch(l){const e=l instanceof Error?l.message:"åœç”¨å“¡å·¥å¤±æ•—";throw a.error(e),l}},activateEmployee:async e=>{try{const l=await s("ACTIVATE_EMPLOYEE",{id:e,name:"",mail:"",role:0});return a.success(l.message||"å“¡å·¥å·²å•Ÿç”¨"),l}catch(l){const e=l instanceof Error?l.message:"å•Ÿç”¨å“¡å·¥å¤±æ•—";throw a.error(e),l}},batchPasswordReset:async e=>{n.value={isRunning:!0,current:0,total:e.length,currentOperation:"æ‰¹é‡å¯†ç¢¼é‡è¨­"};const l={success:[],failed:[]};try{for(let a=0;a<e.length;a++){const{employeeId:u,newPassword:r,employeeName:o}=e[a];n.value.current=a+1;try{await t(u,r),l.success.push(o)}catch(s){l.failed.push(o)}a<e.length-1&&await new Promise(e=>setTimeout(e,100))}return l.success.length>0&&a.success(`æˆåŠŸé‡è¨­ ${l.success.length} ä½å“¡å·¥çš„å¯†ç¢¼`),l.failed.length>0&&a.error(`${l.failed.length} ä½å“¡å·¥çš„å¯†ç¢¼é‡è¨­å¤±æ•—`),l}finally{n.value.isRunning=!1}},callEmployeeAuthAPI:s}})(),k=(()=>{const e=w(),l=a(()=>{var a;return 2===(null==(a=e.user)?void 0:a.role)}),s=a(()=>a=>{var l,s;const t=null==(l=e.user)?void 0:l.role,n=null==(s=e.user)?void 0:s.id;return 2===t||(1!==t&&0!==t||!a?!(1!==t&&0!==t||a):a===n)}),t=a(()=>{var a;return 2===(null==(a=e.user)?void 0:a.role)}),n=a(()=>{var a;return 2===(null==(a=e.user)?void 0:a.role)}),u=a(()=>{var a;return 2===(null==(a=e.user)?void 0:a.role)}),r=a(()=>a=>{var l,s;const t=null==(l=e.user)?void 0:l.role,n=null==(s=e.user)?void 0:s.id;return 2===t||!!a&&a===n}),o=a(()=>{var a;return 2===(null==(a=e.user)?void 0:a.role)}),i=a(()=>{var a;switch(null==(a=e.user)?void 0:a.role){case 0:return"ä¸€èˆ¬å“¡å·¥";case 1:return"æœƒè¨ˆ";case 2:return"ä¸»ç®¡";default:return"æœªçŸ¥è§’è‰²"}}),d=a(()=>{var a;return 2===(null==(a=e.user)?void 0:a.role)}),c=a(()=>{var a;return 1===(null==(a=e.user)?void 0:a.role)}),v=a(()=>{var a;return 0===(null==(a=e.user)?void 0:a.role)});return{canCreateEmployee:l,canEditEmployee:s,canResetPassword:t,canDeactivateEmployee:n,canActivateEmployee:u,canViewEmployee:r,canDeleteEmployee:o,canPerformOperation:(e,a)=>{switch(e){case"create":return l.value;case"edit":return s.value(a);case"view":return r.value(a);case"delete":case"deactivate":return n.value;case"activate":return u.value;case"resetPassword":return t.value;default:return!1}},isManager:d,isAccountant:c,isRegularEmployee:v,currentUserRoleName:i,getRoleName:e=>{switch(e){case 0:return"ä¸€èˆ¬å“¡å·¥";case 1:return"æœƒè¨ˆ";case 2:return"ä¸»ç®¡";default:return"æœªçŸ¥è§’è‰²"}},getRoleClass:e=>{switch(e){case 0:return"role-employee";case 1:return"role-accountant";case 2:return"role-manager";default:return"role-unknown"}}}})(),Te=_(),Ve=e([]),Ae=e(!1),Ne=e(""),Ue=e(""),Se=e(!1),Oe=e(!1),De=e(!1),Le=e(!1),Re=e(null),$e=e(null),xe=e(!1),je=e(null),Me=e(""),Ye=e(""),ze=e({name:"",email:"",password:"",newPassword:"",role:"",pay:0,id_card:"",address:"",birthday:"",insurance:0,insurance_add:0,type:0}),Je=a(()=>{let e=Ve.value;return Ne.value&&(e=e.filter(e=>e.name.toLowerCase().includes(Ne.value.toLowerCase()))),Ue.value&&(e=e.filter(e=>e.role===Number(Ue.value))),e.sort((e,a)=>e.name.localeCompare(a.name))}),qe=a(()=>Me.value&&Ye.value&&Me.value!==Ye.value),Xe=e=>({0:"role-employee",1:"role-manager",2:"role-admin"}[e]||""),We=e=>({0:"ä¸€èˆ¬å“¡å·¥",1:"æœƒè¨ˆ",2:"ä¸»ç®¡"}[e]||"æœªçŸ¥è§’è‰²"),Be=e=>void 0!==e.type?1===e.type?"status-inactive":"status-active":e.deleted_at?"status-inactive":"status-active",Fe=e=>void 0!==e.type?1===e.type?"é›¢è·":"åœ¨è·":e.deleted_at?"é›¢è·":"åœ¨è·",He=e=>new Date(e).toLocaleDateString("zh-TW"),Qe=()=>{ze.value={name:"",email:"",password:"",newPassword:"",role:"0",pay:0,id_card:"",address:"",birthday:"",insurance:0,insurance_add:0,type:0},Re.value=null},Ze=()=>{Qe(),Se.value=!0},Ge=()=>{Se.value=!1,Oe.value=!1,Qe()},Ke=()=>{De.value=!1,$e.value=null},ea=async()=>{Le.value=!0;try{if(Se.value){const e={name:ze.value.name,mail:ze.value.email,password:ze.value.password,role:Number(ze.value.role),pay:ze.value.pay,id_card:ze.value.id_card,address:ze.value.address,birthday:ze.value.birthday||void 0};await E.createEmployee(e)}else if(Re.value){const a={id:Re.value.id,name:ze.value.name,mail:ze.value.email,role:Number(ze.value.role),pay:ze.value.pay,id_card:ze.value.id_card,address:ze.value.address,birthday:ze.value.birthday||void 0,type:Number(ze.value.type)};if(await E.updateEmployee(a),ze.value.newPassword&&""!==ze.value.newPassword.trim())try{await E.resetEmployeePassword(Re.value.id,ze.value.newPassword)}catch(e){}}await aa(),Ge()}catch(a){}finally{Le.value=!1}},aa=async()=>{Ae.value=!0;try{const e=await f.callAPI({table:"staff",action:"read"});e&&Array.isArray(e)&&(Ve.value=e.filter(e=>!e.deleted_at))}catch(e){}finally{Ae.value=!1}},la=()=>{xe.value=!1,je.value=null,Me.value="",Ye.value=""},sa=async()=>{if(je.value&&Me.value){Le.value=!0;try{await E.resetEmployeePassword(je.value.id,Me.value),await aa(),la()}catch(e){}finally{Le.value=!1}}};return s(aa),(e,a)=>{var l;return b(),t("div",C,[n("div",P,[a[23]||(a[23]=n("h1",null,"å“¡å·¥ç®¡ç†",-1)),r(k).canCreateEmployee?(b(),t("button",{key:0,onClick:Ze,class:"btn btn-primary"}," æ–°å¢å“¡å·¥ ")):u("",!0)]),n("div",I,[o(n("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>Ne.value=e),type:"text",placeholder:"æœå°‹å“¡å·¥å§“å...",class:"search-input"},null,512),[[i,Ne.value]]),o(n("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>Ue.value=e),class:"filter-select"},a[24]||(a[24]=[n("option",{value:""},"æ‰€æœ‰è§’è‰²",-1),n("option",{value:"0"},"ä¸€èˆ¬å“¡å·¥",-1),n("option",{value:"1"},"æœƒè¨ˆ",-1),n("option",{value:"2"},"ä¸»ç®¡",-1)]),512),[[d,Ue.value]])]),Ae.value?(b(),t("div",T,"è¼‰å…¥ä¸­...")):0===Je.value.length?(b(),t("div",V,a[25]||(a[25]=[n("div",{class:"empty-icon"},"ğŸ‘¥",-1),n("p",null,"å°šç„¡å“¡å·¥è³‡æ–™",-1)]))):(b(),t("div",A,[n("table",null,[a[26]||(a[26]=n("thead",null,[n("tr",null,[n("th",null,"å§“å"),n("th",null,"è§’è‰²"),n("th",null,"è–ªè³‡"),n("th",null,"åŠ å…¥æ—¥æœŸ"),n("th",null,"ç‹€æ…‹")])],-1)),n("tbody",null,[(b(!0),t(c,null,v(Je.value,e=>(b(),t("tr",{key:e.id,onClick:a=>(e=>{$e.value=e,De.value=!0})(e),class:"clickable-row"},[n("td",U,[n("div",null,p(e.name),1),n("div",S,p(e.mail||"æœªè¨­å®šä¿¡ç®±"),1)]),n("td",null,[n("span",{class:y(["role-badge",Xe(e.role)])},p(We(e.role)),3)]),n("td",O,"NT$ "+p(e.pay?e.pay.toLocaleString():"0"),1),n("td",null,p(He(e.created_at)),1),n("td",null,[n("span",{class:y(["status-badge",Be(e)])},p(Fe(e)),3)])],8,N))),128))])])])),Se.value||Oe.value?(b(),t("div",{key:3,class:"modal-overlay edit-modal-overlay",onClick:Ge},[n("div",{class:"modal",onClick:a[14]||(a[14]=m(()=>{},["stop"]))},[n("div",D,[n("h2",null,p(Se.value?"æ–°å¢å“¡å·¥":"ç·¨è¼¯å“¡å·¥"),1),n("button",{onClick:Ge,class:"close-btn"},"Ã—")]),n("form",{onSubmit:m(ea,["prevent"]),class:"modal-body"},[n("div",L,[n("div",R,[a[33]||(a[33]=n("h3",{class:"column-title"},"åŸºæœ¬è³‡æ–™",-1)),n("div",$,[a[27]||(a[27]=n("label",null,"å§“å *",-1)),o(n("input",{"onUpdate:modelValue":a[2]||(a[2]=e=>ze.value.name=e),type:"text",required:""},null,512),[[i,ze.value.name]])]),n("div",x,[a[28]||(a[28]=n("label",null,"é›»å­éƒµä»¶ *",-1)),o(n("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>ze.value.email=e),type:"email",required:"",disabled:Oe.value},null,8,j),[[i,ze.value.email]])]),Se.value?(b(),t("div",M,[a[29]||(a[29]=n("label",null,"åˆå§‹å¯†ç¢¼ *",-1)),o(n("input",{"onUpdate:modelValue":a[4]||(a[4]=e=>ze.value.password=e),type:"password",required:""},null,512),[[i,ze.value.password]])])):u("",!0),Oe.value?(b(),t("div",Y,[a[30]||(a[30]=n("label",null,"é‡è¨­å¯†ç¢¼",-1)),o(n("input",{"onUpdate:modelValue":a[5]||(a[5]=e=>ze.value.newPassword=e),type:"password",placeholder:"ç•™ç©ºå‰‡ä¸ä¿®æ”¹"},null,512),[[i,ze.value.newPassword]])])):u("",!0),n("div",z,[a[32]||(a[32]=n("label",null,"è§’è‰² *",-1)),o(n("select",{"onUpdate:modelValue":a[6]||(a[6]=e=>ze.value.role=e),required:""},a[31]||(a[31]=[n("option",{value:""},"è«‹é¸æ“‡è§’è‰²",-1),n("option",{value:"0"},"ä¸€èˆ¬å“¡å·¥",-1),n("option",{value:"1"},"æœƒè¨ˆ",-1),n("option",{value:"2"},"ä¸»ç®¡",-1)]),512),[[d,ze.value.role]])])]),n("div",J,[a[42]||(a[42]=n("h3",{class:"column-title"},"è©³ç´°è³‡æ–™",-1)),n("div",q,[a[34]||(a[34]=n("label",null,"è–ªè³‡",-1)),o(n("input",{"onUpdate:modelValue":a[7]||(a[7]=e=>ze.value.pay=e),type:"number",min:"0"},null,512),[[i,ze.value.pay,void 0,{number:!0}]])]),n("div",X,[a[35]||(a[35]=n("label",null,"èº«åˆ†è­‰å­—è™Ÿ",-1)),o(n("input",{"onUpdate:modelValue":a[8]||(a[8]=e=>ze.value.id_card=e),type:"text",maxlength:"10"},null,512),[[i,ze.value.id_card]])]),n("div",W,[a[36]||(a[36]=n("label",null,"ç”Ÿæ—¥",-1)),o(n("input",{"onUpdate:modelValue":a[9]||(a[9]=e=>ze.value.birthday=e),type:"date"},null,512),[[i,ze.value.birthday]])]),n("div",B,[a[37]||(a[37]=n("label",null,"åœ°å€",-1)),o(n("input",{"onUpdate:modelValue":a[10]||(a[10]=e=>ze.value.address=e),rows:"2"},null,512),[[i,ze.value.address]])]),n("div",F,[a[38]||(a[38]=n("label",null,"å‹å¥ä¿è²»ç”¨",-1)),o(n("input",{"onUpdate:modelValue":a[11]||(a[11]=e=>ze.value.insurance=e),type:"number",min:"0"},null,512),[[i,ze.value.insurance,void 0,{number:!0}]])]),n("div",H,[a[39]||(a[39]=n("label",null,"å‹å¥ä¿åŠ ä¿è²»ç”¨",-1)),o(n("input",{"onUpdate:modelValue":a[12]||(a[12]=e=>ze.value.insurance_add=e),type:"number",min:"0"},null,512),[[i,ze.value.insurance_add,void 0,{number:!0}]])]),Oe.value?(b(),t("div",Q,[a[41]||(a[41]=n("label",null,"å“¡å·¥ç‹€æ…‹ *",-1)),o(n("select",{"onUpdate:modelValue":a[13]||(a[13]=e=>ze.value.type=e),required:""},a[40]||(a[40]=[n("option",{value:"0"},"åœ¨è·",-1),n("option",{value:"1"},"é›¢è·",-1)]),512),[[d,ze.value.type]])])):u("",!0)])]),n("div",Z,[n("button",{type:"button",onClick:Ge,class:"btn btn-outline"}," å–æ¶ˆ "),n("button",{type:"submit",class:"btn btn-primary",disabled:Le.value},p(Le.value?"è™•ç†ä¸­...":Se.value?"æ–°å¢":"æ›´æ–°"),9,G)])],32)])])):u("",!0),De.value&&$e.value?(b(),t("div",{key:4,class:"modal-overlay",onClick:Ke},[n("div",{class:"modal detail-modal",onClick:a[19]||(a[19]=m(()=>{},["stop"]))},[n("div",{class:"modal-header"},[a[43]||(a[43]=n("h2",null,"å“¡å·¥è©³ç´°è³‡æ–™",-1)),n("button",{onClick:Ke,class:"close-btn"},"Ã—")]),n("div",K,[n("div",ee,[n("div",ae,[a[48]||(a[48]=n("h3",null,"åŸºæœ¬è³‡æ–™",-1)),n("div",le,[a[44]||(a[44]=n("label",null,"å§“å",-1)),n("span",null,p($e.value.name),1)]),n("div",se,[a[45]||(a[45]=n("label",null,"é›»å­éƒµä»¶",-1)),n("span",null,p($e.value.mail||"æœªè¨­å®š"),1)]),n("div",te,[a[46]||(a[46]=n("label",null,"è§’è‰²",-1)),n("span",{class:y(["role-badge",Xe($e.value.role)])},p(We($e.value.role)),3)]),n("div",ne,[a[47]||(a[47]=n("label",null,"ç‹€æ…‹",-1)),n("span",{class:y(["status-badge",Be($e.value)])},p(Fe($e.value)),3)])]),n("div",ue,[a[52]||(a[52]=n("h3",null,"å€‹äººè³‡æ–™",-1)),n("div",re,[a[49]||(a[49]=n("label",null,"èº«åˆ†è­‰å­—è™Ÿ",-1)),n("span",null,p($e.value.id_card||"æœªè¨­å®š"),1)]),n("div",oe,[a[50]||(a[50]=n("label",null,"ç”Ÿæ—¥",-1)),n("span",null,p($e.value.birthday?He($e.value.birthday):"æœªè¨­å®š"),1)]),n("div",ie,[a[51]||(a[51]=n("label",null,"åœ°å€",-1)),n("span",null,p($e.value.address||"æœªè¨­å®š"),1)])]),n("div",de,[a[56]||(a[56]=n("h3",null,"è–ªè³‡èˆ‡ä¿éšª",-1)),n("div",ce,[a[53]||(a[53]=n("label",null,"è–ªè³‡",-1)),n("span",ve,"NT$ "+p($e.value.pay?$e.value.pay.toLocaleString():"0"),1)]),n("div",pe,[a[54]||(a[54]=n("label",null,"å‹å¥ä¿è²»ç”¨",-1)),n("span",null,"NT$ "+p($e.value.insurance?$e.value.insurance.toLocaleString():"0"),1)]),n("div",me,[a[55]||(a[55]=n("label",null,"å‹å¥ä¿åŠ ä¿è²»ç”¨",-1)),n("span",null,"NT$ "+p($e.value.insurance_add?$e.value.insurance_add.toLocaleString():"0"),1)])]),n("div",ye,[a[60]||(a[60]=n("h3",null,"ç³»çµ±è³‡æ–™",-1)),n("div",be,[a[57]||(a[57]=n("label",null,"å“¡å·¥ç·¨è™Ÿ",-1)),n("span",null,p($e.value.id),1)]),n("div",he,[a[58]||(a[58]=n("label",null,"å»ºç«‹æ™‚é–“",-1)),n("span",null,p(He($e.value.created_at)),1)]),$e.value.updated_at?(b(),t("div",we,[a[59]||(a[59]=n("label",null,"æœ€å¾Œæ›´æ–°",-1)),n("span",null,p(He($e.value.updated_at)),1)])):u("",!0)])]),n("div",ge,[r(k).canEditEmployee.value($e.value.id)?(b(),t("button",{key:0,onClick:a[15]||(a[15]=e=>{return a=$e.value,Re.value=a,ze.value={name:a.name,email:a.mail||"",password:"",newPassword:"",role:a.role.toString(),pay:a.pay||0,id_card:a.id_card||"",address:a.address||"",birthday:a.birthday?new Date(a.birthday).toISOString().split("T")[0]:"",insurance:a.insurance||0,insurance_add:a.insurance_add||0,type:a.type||0},void(Oe.value=!0);var a}),class:"btn btn-primary"}," ç·¨è¼¯å“¡å·¥ ")):u("",!0),r(k).canResetPassword?(b(),t("button",{key:1,onClick:a[16]||(a[16]=e=>{return a=$e.value,je.value=a,Me.value="",Ye.value="",void(xe.value=!0);var a}),class:"btn btn-outline"}," é‡è¨­å¯†ç¢¼ ")):u("",!0),r(k).canDeactivateEmployee&&"åœ¨è·"===Fe($e.value)?(b(),t("button",{key:2,onClick:a[17]||(a[17]=e=>(async e=>{if(confirm(`ç¢ºå®šè¦åœç”¨å“¡å·¥ã€Œ${e.name}ã€å—ï¼Ÿ`))try{await f.callAPI({table:"staff",action:"update",data:{id:e.id,type:1}}),Te.success(`å“¡å·¥ã€Œ${e.name}ã€å·²åœç”¨`),await aa(),Ke()}catch(a){Te.error("åœç”¨å“¡å·¥å¤±æ•—")}})($e.value)),class:"btn btn-danger"}," åœç”¨ ")):u("",!0),r(k).canActivateEmployee&&"é›¢è·"===Fe($e.value)?(b(),t("button",{key:3,onClick:a[18]||(a[18]=e=>(async e=>{if(confirm(`ç¢ºå®šè¦å•Ÿç”¨å“¡å·¥ã€Œ${e.name}ã€å—ï¼Ÿ`))try{await f.callAPI({table:"staff",action:"update",data:{id:e.id,type:0}}),Te.success(`å“¡å·¥ã€Œ${e.name}ã€å·²å•Ÿç”¨`),await aa(),Ke()}catch(a){Te.error("å•Ÿç”¨å“¡å·¥å¤±æ•—")}})($e.value)),class:"btn btn-success"}," å•Ÿç”¨ ")):u("",!0),n("button",{onClick:Ke,class:"btn btn-outline"}," é—œé–‰ ")])])])])):u("",!0),xe.value?(b(),t("div",{key:5,class:"modal-overlay",onClick:la},[n("div",{class:"modal",onClick:a[22]||(a[22]=m(()=>{},["stop"]))},[n("div",fe,[n("h2",null,"é‡è¨­å¯†ç¢¼ - "+p(null==(l=je.value)?void 0:l.name),1),n("button",{onClick:la,class:"close-btn"},"Ã—")]),n("form",{onSubmit:m(sa,["prevent"]),class:"modal-body"},[n("div",Ee,[a[61]||(a[61]=n("label",null,"æ–°å¯†ç¢¼ *",-1)),o(n("input",{"onUpdate:modelValue":a[20]||(a[20]=e=>Me.value=e),type:"password",required:"",minlength:"6",placeholder:"è«‹è¼¸å…¥æ–°å¯†ç¢¼ï¼ˆè‡³å°‘6å€‹å­—å…ƒï¼‰"},null,512),[[i,Me.value]])]),n("div",ke,[a[62]||(a[62]=n("label",null,"ç¢ºèªæ–°å¯†ç¢¼ *",-1)),o(n("input",{"onUpdate:modelValue":a[21]||(a[21]=e=>Ye.value=e),type:"password",required:"",minlength:"6",placeholder:"è«‹å†æ¬¡è¼¸å…¥æ–°å¯†ç¢¼"},null,512),[[i,Ye.value]])]),qe.value?(b(),t("div",_e," å…©æ¬¡è¼¸å…¥çš„å¯†ç¢¼ä¸ä¸€è‡´ ")):u("",!0),n("div",Ce,[n("button",{type:"button",onClick:la,class:"btn btn-outline"}," å–æ¶ˆ "),n("button",{type:"submit",class:"btn btn-primary",disabled:Le.value||qe.value||!Me.value||!Ye.value},p(Le.value?"é‡è¨­ä¸­...":"é‡è¨­å¯†ç¢¼"),9,Pe)])],32)])])):u("",!0),r(E).isLoading.value?(b(),t("div",Ie,a[63]||(a[63]=[n("div",{class:"loading-content"},[n("div",{class:"spinner"}),n("p",null,"è™•ç†ä¸­ï¼Œè«‹ç¨å€™...")],-1)]))):u("",!0)])}}}),[["__scopeId","data-v-13d1a864"]]);export{Te as default};
